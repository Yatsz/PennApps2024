import React, { useEffect, useState } from 'react'

interface SurveillanceVideoProps {
  floor: string
  camNum: number
  severity: 'HIGH' | 'MEDIUM' | 'LOW'
  videoUrl: string
}

const severityConfig = {
  HIGH: { width: 'w-[43px]', color: 'text-[#FF1313]', border: 'border-[#FF1313]', bg: 'bg-[#FFD4D4]' },
  MEDIUM: { width: 'w-[61px]', color: 'text-[#FF8C00]', border: 'border-[#FF8C00]', bg: 'bg-[#FFDFC4]' },
  LOW: { width: 'w-[40px]', color: 'text-[#E4D141]', border: 'border-[#E4D141]', bg: 'bg-[#FFFBD9]' }
}

export default function SurveillanceVideo({ floor, camNum, severity, videoUrl }: SurveillanceVideoProps) {
  const [videoSource, setVideoSource] = useState<string | undefined>(undefined);

  useEffect(() => {
    setVideoSource(videoUrl);
  }, [videoUrl]);

  const { width, color, border, bg } = severityConfig[severity];

  return (
    <div className="relative inline-block custom-shadow">
      <div className="w-[437px] h-[338px] bg-white rounded-lg shadow-lg overflow-hidden">
        <div className="p-4 pb-0">
          <div className="flex justify-between items-center mb-[4px]">
            <h2 className="text-black text-opacity-50 text-[14px] font-normal">Surveillance Video</h2>
            <div className="flex space-x-2">
              <button className="text-gray-600 hover:text-gray-800">
                <svg width="19" height="19" viewBox="0 0 19 19" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M10.6351 9.04382C10.5513 9.12755 10.4378 9.17459 10.3194 9.17459C10.201 9.17459 10.0874 9.12755 10.0037 9.04382C9.91994 8.96009 9.8729 8.84652 9.8729 8.72811C9.8729 8.6097 9.91994 8.49614 10.0037 8.41241L13.5709 4.84512C13.6124 4.80367 13.6616 4.77078 13.7158 4.74834C13.77 4.7259 13.828 4.71436 13.8867 4.71436C13.9453 4.71436 14.0033 4.7259 14.0575 4.74834C14.1117 4.77078 14.1609 4.80367 14.2024 4.84512C14.2438 4.88658 14.2767 4.9358 14.2991 4.98997C14.3216 5.04414 14.3331 5.1022 14.3331 5.16083C14.3331 5.21946 14.3216 5.27752 14.2991 5.33169C14.2767 5.38586 14.2438 5.43507 14.2024 5.47653L10.6351 9.04382ZM5.28415 14.3947C5.24269 14.4362 5.19347 14.4691 5.1393 14.4915C5.08514 14.514 5.02708 14.5255 4.96845 14.5255C4.90981 14.5255 4.85176 14.514 4.79759 14.4915C4.74342 14.4691 4.6942 14.4362 4.65274 14.3947C4.61128 14.3533 4.5784 14.3041 4.55596 14.2499C4.53352 14.1957 4.52197 14.1377 4.52197 14.079C4.52197 14.0204 4.53352 13.9623 4.55596 13.9082C4.5784 13.854 4.61128 13.8048 4.65274 13.7633L8.22002 10.196C8.30375 10.1123 8.41732 10.0653 8.53573 10.0653C8.65414 10.0653 8.7677 10.1123 8.85143 10.196C8.93516 10.2798 8.9822 10.3933 8.9822 10.5118C8.9822 10.6302 8.93516 10.7437 8.85143 10.8275L5.28415 14.3947Z" fill="black"/>
                  <path d="M4.96837 14.5251C4.85011 14.5251 4.73669 14.4781 4.65307 14.3945C4.56944 14.3109 4.52246 14.1975 4.52246 14.0792C4.52246 13.9609 4.56944 13.8475 4.65307 13.7639C4.73669 13.6803 4.85011 13.6333 4.96837 13.6333H8.53565C8.65392 13.6333 8.76734 13.6803 8.85096 13.7639C8.93458 13.8475 8.98156 13.9609 8.98156 14.0792C8.98156 14.1975 8.93458 14.3109 8.85096 14.3945C8.76734 14.4781 8.65392 14.5251 8.53565 14.5251H4.96837Z" fill="black"/>
                  <path d="M5.41453 14.0792C5.41453 14.1975 5.36755 14.3109 5.28392 14.3945C5.2003 14.4781 5.08688 14.5251 4.96862 14.5251C4.85035 14.5251 4.73693 14.4781 4.65331 14.3945C4.56968 14.3109 4.52271 14.1975 4.52271 14.0792V10.5119C4.52271 10.3937 4.56968 10.2802 4.65331 10.1966C4.73693 10.113 4.85035 10.066 4.96862 10.066C5.08688 10.066 5.2003 10.113 5.28392 10.1966C5.36755 10.2802 5.41453 10.3937 5.41453 10.5119V14.0792ZM14.3327 8.72828C14.3327 8.84654 14.2858 8.95996 14.2021 9.04359C14.1185 9.12721 14.0051 9.17419 13.8868 9.17419C13.7686 9.17419 13.6551 9.12721 13.5715 9.04359C13.4879 8.95996 13.4409 8.84654 13.4409 8.72828V5.161C13.4409 5.04274 13.4879 4.92932 13.5715 4.84569C13.6551 4.76207 13.7686 4.71509 13.8868 4.71509C14.0051 4.71509 14.1185 4.76207 14.2021 4.84569C14.2858 4.92932 14.3327 5.04274 14.3327 5.161V8.72828Z" fill="black"/>
                  <path d="M10.3192 5.60691C10.2009 5.60691 10.0875 5.55993 10.0039 5.4763C9.92027 5.39268 9.87329 5.27926 9.87329 5.161C9.87329 5.04274 9.92027 4.92932 10.0039 4.84569C10.0875 4.76207 10.2009 4.71509 10.3192 4.71509H13.8865C14.0047 4.71509 14.1182 4.76207 14.2018 4.84569C14.2854 4.92932 14.3324 5.04274 14.3324 5.161C14.3324 5.27926 14.2854 5.39268 14.2018 5.4763C14.1182 5.55993 14.0047 5.60691 13.8865 5.60691H10.3192Z" fill="black"/>
                </svg>
              </button>
              <button className="text-gray-600 hover:text-gray-800">
                <svg width="12" height="3" viewBox="0 0 12 3" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M9.39843 1.62015C9.39843 1.32449 9.51588 1.04094 9.72494 0.831881C9.934 0.62282 10.2175 0.505371 10.5132 0.505371C10.8089 0.505371 11.0924 0.62282 11.3015 0.831881C11.5105 1.04094 11.628 1.32449 11.628 1.62015C11.628 1.9158 11.5105 2.19935 11.3015 2.40841C11.0924 2.61747 10.8089 2.73492 10.5132 2.73492C10.2175 2.73492 9.934 2.61747 9.72494 2.40841C9.51588 2.19935 9.39843 1.9158 9.39843 1.62015ZM4.93933 1.62015C4.93933 1.32449 5.05678 1.04094 5.26584 0.831881C5.4749 0.62282 5.75845 0.505371 6.0541 0.505371C6.34976 0.505371 6.63331 0.62282 6.84237 0.831881C7.05143 1.04094 7.16888 1.32449 7.16888 1.62015C7.16888 1.9158 7.05143 2.19935 6.84237 2.40841C6.63331 2.61747 6.34976 2.73492 6.0541 2.73492C5.75845 2.73492 5.4749 2.61747 5.26584 2.40841C5.05678 2.19935 4.93933 1.9158 4.93933 1.62015ZM0.480225 1.62015C0.480225 1.32449 0.597674 1.04094 0.806735 0.831881C1.0158 0.62282 1.29934 0.505371 1.595 0.505371C1.89066 0.505371 2.1742 0.62282 2.38327 0.831881C2.59233 1.04094 2.70978 1.32449 2.70978 1.62015C2.70978 1.9158 2.59233 2.19935 2.38327 2.40841C2.1742 2.61747 1.89066 2.73492 1.595 2.73492C1.29934 2.73492 1.0158 2.61747 0.806735 2.40841C0.597674 2.19935 0.480225 1.9158 0.480225 1.62015Z" fill="black"/>
                </svg>
              </button>
            </div>
          </div>
          <div className="flex items-center space-x-2 mb-2">
            <h3 className="text-black text-[14px] font-bold uppercase">{floor}</h3>
            <div className="flex items-center justify-center w-[35px] h-[18px] border border-black border-opacity-50 rounded-[2px]">
              <svg width="13" height="14" viewBox="0 0 13 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                <g opacity="0.5">
                  <path d="M10.4583 3.4171H9.10638L8.44162 2.42021C8.40601 2.36683 8.35778 2.32306 8.3012 2.29277C8.24463 2.26249 8.18146 2.24662 8.11729 2.24658H4.99592C4.93175 2.24662 4.86858 2.26249 4.81201 2.29277C4.75543 2.32306 4.7072 2.36683 4.67159 2.42021L4.00635 3.4171H2.65489C2.34445 3.4171 2.04672 3.54042 1.82721 3.75993C1.6077 3.97945 1.48438 4.27717 1.48438 4.58761V10.05C1.48438 10.3605 1.6077 10.6582 1.82721 10.8777C2.04672 11.0972 2.34445 11.2205 2.65489 11.2205H10.4583C10.7688 11.2205 11.0665 11.0972 11.286 10.8777C11.5055 10.6582 11.6288 10.3605 11.6288 10.05V4.58761C11.6288 4.27717 11.5055 3.97945 11.286 3.75993C11.0665 3.54042 10.7688 3.4171 10.4583 3.4171ZM10.8485 10.05C10.8485 10.1535 10.8074 10.2527 10.7342 10.3259C10.661 10.3991 10.5618 10.4402 10.4583 10.4402H2.65489C2.55141 10.4402 2.45217 10.3991 2.379 10.3259C2.30583 10.2527 2.26472 10.1535 2.26472 10.05V4.58761C2.26472 4.48413 2.30583 4.38489 2.379 4.31172C2.45217 4.23855 2.55141 4.19744 2.65489 4.19744H4.21558C4.27983 4.19748 4.3431 4.18165 4.39976 4.15137C4.45643 4.12108 4.50473 4.07726 4.54039 4.02381L5.20466 3.02693H7.90806L8.57282 4.02381C8.60848 4.07726 8.65678 4.12108 8.71345 4.15137C8.77011 4.18165 8.83338 4.19748 8.89763 4.19744H10.4583C10.5618 4.19744 10.661 4.23855 10.7342 4.31172C10.8074 4.38489 10.8485 4.48413 10.8485 4.58761V10.05ZM6.5566 4.97778C6.13218 4.97778 5.71728 5.10364 5.36438 5.33944C5.01148 5.57524 4.73643 5.91039 4.57401 6.30251C4.41159 6.69463 4.36909 7.12611 4.4519 7.54238C4.5347 7.95865 4.73908 8.34102 5.03919 8.64114C5.33931 8.94125 5.72168 9.14563 6.13795 9.22844C6.55422 9.31124 6.9857 9.26874 7.37782 9.10632C7.76994 8.9439 8.10509 8.66885 8.34089 8.31595C8.57669 7.96305 8.70255 7.54815 8.70255 7.12373C8.7019 6.55478 8.47561 6.00933 8.0733 5.60703C7.671 5.20472 7.12555 4.97843 6.5566 4.97778ZM6.5566 8.48933C6.28651 8.48933 6.02249 8.40923 5.79792 8.25918C5.57335 8.10913 5.39831 7.89585 5.29495 7.64632C5.1916 7.39679 5.16455 7.12221 5.21724 6.85731C5.26994 6.59241 5.4 6.34908 5.59098 6.1581C5.78196 5.96712 6.02529 5.83706 6.29019 5.78437C6.55509 5.73167 6.82967 5.75872 7.0792 5.86208C7.32873 5.96543 7.54201 6.14047 7.69206 6.36504C7.84211 6.58961 7.9222 6.85364 7.9222 7.12373C7.9222 7.48591 7.77833 7.83325 7.52223 8.08935C7.26613 8.34545 6.91878 8.48933 6.5566 8.48933Z" fill="black"/>
                </g>
              </svg>
              <span className="text-[12px] text-black text-opacity-50 ml-1">{camNum}</span>
            </div>
            <div className={`h-[19px] ${width} ${color} ${border} ${bg} border rounded-[2px] flex items-center justify-center`}>
              <span className="text-[12.5px] font-normal">{severity}</span>
            </div>
          </div>
        </div>
        <div className="relative w-[417px] h-[258px] mx-auto overflow-hidden">
          {videoSource && (
            <video 
              src={videoSource} 
              className="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 min-w-full min-h-full object-cover" 
              loop 
              muted 
              playsInline
              controls
              autoPlay
            >
              Your browser does not support the video tag.
            </video>
          )}
          <div className="absolute bottom-2 right-2 bg-black bg-opacity-50 text-white px-2 py-1 rounded">
            Live
          </div>
        </div>
      </div>
      <div className="absolute top-1/2 right-0 transform -translate-y-1/2 translate-x-full">
        <svg width="27" height="54" viewBox="0 0 27 54" fill="white" xmlns="http://www.w3.org/2000/svg">
          <path d="M0 0 L27 27 L0 54 Z" />
        </svg>
      </div>
    </div>
  )
}